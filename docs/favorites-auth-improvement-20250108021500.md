# Favorites é¡µé¢è®¤è¯çŠ¶æ€æ”¹è¿›

## æ¦‚è¿°
ä¼˜åŒ–äº† Favorites é¡µé¢çš„ç™»å½•æç¤ºæœºåˆ¶ï¼Œæä¾›æ›´å‡†ç¡®çš„ç”¨æˆ·çŠ¶æ€æ£€æµ‹å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

## é—®é¢˜è§£å†³

### ä¹‹å‰çš„é—®é¢˜
1. **çŠ¶æ€æ£€æµ‹ä¸å‡†ç¡®**ï¼šå®‰å…¨æ¨¡å¼ä¸‹æ€»æ˜¯æ˜¾ç¤ºæœªç™»å½•çŠ¶æ€ï¼Œå³ä½¿ç”¨æˆ·å·²ç™»å½•
2. **ç©ºçŠ¶æ€ç¼ºå°‘ç™»å½•å¼•å¯¼**ï¼šæœªç™»å½•ç”¨æˆ·çœ‹ä¸åˆ°ç™»å½•æç¤º
3. **æç¤ºä¿¡æ¯è¯¯å¯¼**ï¼šå·²ç™»å½•ç”¨æˆ·ä»çœ‹åˆ°"Sign in to sync"æ¶ˆæ¯

### è§£å†³æ–¹æ¡ˆ

#### 1. æ™ºèƒ½è®¤è¯çŠ¶æ€æ£€æµ‹ (`useAuthStatus`)
åˆ›å»ºäº†èƒ½åŒºåˆ†ä¸‰ç§è®¤è¯çŠ¶æ€çš„ hookï¼š

```typescript
type AuthState = 
  | 'not-authenticated'      // ç”¨æˆ·æœªç™»å½•
  | 'authenticated-limited'  // ç”¨æˆ·å·²ç™»å½•ä½†ClerkåŠŸèƒ½å—é™  
  | 'authenticated-full';    // ç”¨æˆ·å·²ç™»å½•ä¸”åŠŸèƒ½å®Œæ•´
```

**æ£€æµ‹é€»è¾‘**ï¼š
- âœ… æ£€æŸ¥ `VITE_CLERK_PUBLISHABLE_KEY` ç¯å¢ƒå˜é‡
- âœ… æ£€æŸ¥ `window.Clerk` å®ä¾‹æ˜¯å¦å­˜åœ¨
- âœ… æ£€æŸ¥ç”¨æˆ·å®é™…ç™»å½•çŠ¶æ€
- âœ… æ ¹æ®ç¯å¢ƒå’ŒçŠ¶æ€è¿”å›å‡†ç¡®çš„è®¤è¯çŠ¶æ€

#### 2. æ”¹è¿›çš„åŒæ­¥çŠ¶æ€ç®¡ç† (`useFavoritesSync`)
æ›´æ–°äº†æ”¶è—åŒæ­¥ hookï¼š

```typescript
interface FavoritesSyncStatus {
  authState: AuthState;
  displayMessage: string | null;
  isSignedIn: boolean;
  canSync: boolean;
  // ... å…¶ä»–å­—æ®µ
}
```

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- ğŸ¯ æ ¹æ®è®¤è¯çŠ¶æ€æä¾›ä¸åŒåŠŸèƒ½
- ğŸ“ æ™ºèƒ½ç”ŸæˆçŠ¶æ€æç¤ºæ¶ˆæ¯
- ğŸ”„ ä¿æŒå‘åå…¼å®¹æ€§

#### 3. ä¼˜åŒ–çš„ç”¨æˆ·ç•Œé¢

**çŠ¶æ€æç¤ºæ–‡æ¡ˆ**ï¼š
```typescript
// æ ¹æ®è®¤è¯çŠ¶æ€æ˜¾ç¤ºä¸åŒé¢œè‰²å’Œæ¶ˆæ¯
{displayMessage && (
  <span className={authState === 'authenticated-limited' 
    ? 'text-orange-600' // åŠŸèƒ½å—é™æ—¶ç”¨æ©™è‰²
    : 'text-amber-600'  // æœªç™»å½•æ—¶ç”¨ç¥ç€è‰²
  }>
    â€¢ {displayMessage}
  </span>
)}
```

**æ”¹è¿›çš„ç©ºçŠ¶æ€é¡µé¢**ï¼š
- **æœªç™»å½•ç”¨æˆ·**ï¼š
  - æ–‡æ¡ˆï¼š"Sign in to save your favorite MCP servers..."
  - æŒ‰é’®ï¼šç»¿è‰²çš„"Sign In to Save Favorites"æŒ‰é’®
  - å¼•å¯¼ï¼šæ˜ç¡®æç¤ºç™»å½•çš„å¥½å¤„

- **å·²ç™»å½•ç”¨æˆ·**ï¼š
  - æ–‡æ¡ˆï¼š"Start exploring MCP servers..."
  - æŒ‰é’®ï¼šè“è‰²çš„"Browse Servers"æŒ‰é’®
  - ä½“éªŒï¼šä¸æ˜¾ç¤ºå¤šä½™çš„ç™»å½•æç¤º

## ç”¨æˆ·ä½“éªŒæ”¹è¿›

### ä¸åŒåœºæ™¯ä¸‹çš„è¡¨ç°

#### åœºæ™¯ 1: æœªé…ç½® Clerk (ç”Ÿäº§ç¯å¢ƒé—®é¢˜)
- **çŠ¶æ€**: `not-authenticated`
- **ç©ºçŠ¶æ€**: æ˜¾ç¤ºç™»å½•CTAï¼Œç‚¹å‡»æ—¶æç¤ºé…ç½®é—®é¢˜
- **æç¤º**: "Sign in to sync favorites across devices"

#### åœºæ™¯ 2: é…ç½®äº† Clerk ä½†ç”¨æˆ·æœªç™»å½•
- **çŠ¶æ€**: `not-authenticated`
- **ç©ºçŠ¶æ€**: æ˜¾ç¤ºåŠŸèƒ½æ€§çš„ç™»å½•æŒ‰é’®
- **æç¤º**: "Sign in to sync favorites across devices"

#### åœºæ™¯ 3: ç”¨æˆ·å·²ç™»å½•ä½†åŠŸèƒ½å—é™
- **çŠ¶æ€**: `authenticated-limited`
- **ç©ºçŠ¶æ€**: ä¸æ˜¾ç¤ºç™»å½•æŒ‰é’®ï¼Œåªæ˜¾ç¤ºæµè§ˆæŒ‰é’®
- **æç¤º**: "Limited sync features - sign in on a supported device" (æ©™è‰²)

#### åœºæ™¯ 4: ç”¨æˆ·å·²ç™»å½•ä¸”åŠŸèƒ½å®Œæ•´
- **çŠ¶æ€**: `authenticated-full`
- **ç©ºçŠ¶æ€**: æ˜¾ç¤ºæµè§ˆæŒ‰é’®
- **æç¤º**: æ— æç¤ºä¿¡æ¯

## æŠ€æœ¯å®ç°

### æ–‡ä»¶ä¿®æ”¹
1. **æ–°å¢**: `src/hooks/useAuthStatus.ts` - æ™ºèƒ½è®¤è¯çŠ¶æ€æ£€æµ‹
2. **æ”¹è¿›**: `src/hooks/useFavoritesSync.ts` - é›†æˆæ–°çš„çŠ¶æ€æ£€æµ‹
3. **ä¼˜åŒ–**: `src/pages/Favorites.tsx` - æ”¹è¿›ç”¨æˆ·ç•Œé¢å’Œæç¤º

### ç±»å‹å®‰å…¨
```typescript
// å¯¼å‡ºçš„æ¥å£ç¡®ä¿ç±»å‹å®‰å…¨
export interface FavoritesSyncStatus {
  authState: 'not-authenticated' | 'authenticated-limited' | 'authenticated-full';
  displayMessage: string | null;
  // ...
}
```

### å‘åå…¼å®¹æ€§
- âœ… ä¿æŒæ‰€æœ‰ç°æœ‰APIä¸å˜
- âœ… ç°æœ‰ç»„ä»¶æ— éœ€ä¿®æ”¹
- âœ… æ¸è¿›å¼å¢å¼ºï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½

## æµ‹è¯•åœºæ™¯

### æœ¬åœ°å¼€å‘
```bash
# æœ‰Clerké…ç½®ä¸”ç™»å½•
VITE_CLERK_PUBLISHABLE_KEY=pk_test_xxx npm run dev

# æœ‰Clerké…ç½®ä½†æœªç™»å½•  
VITE_CLERK_PUBLISHABLE_KEY=pk_test_xxx npm run dev

# æ— Clerké…ç½®
npm run dev
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# æ­£ç¡®é…ç½®
VITE_CLERK_PUBLISHABLE_KEY=pk_live_xxx npm run build

# é…ç½®ç¼ºå¤±
npm run build
```

## é¢„æœŸæ•ˆæœ

### å¯¹ç”¨æˆ·çš„æ”¹è¿›
1. **æœªç™»å½•ç”¨æˆ·**ï¼šæ¸…æ¥šåœ°çŸ¥é“ç™»å½•çš„å¥½å¤„ï¼Œæœ‰æ˜ç¡®çš„è¡ŒåŠ¨æŒ‡å¼•
2. **å·²ç™»å½•ç”¨æˆ·**ï¼šä¸ä¼šçœ‹åˆ°è¯¯å¯¼æ€§çš„ç™»å½•æç¤º
3. **æŠ€æœ¯é—®é¢˜æ—¶**ï¼šå¾—åˆ°åˆé€‚çš„åé¦ˆï¼Œè€Œä¸æ˜¯é”™è¯¯ä¿¡æ¯

### å¯¹å¼€å‘çš„æ”¹è¿›
1. **çŠ¶æ€æ¸…æ™°**ï¼šä¸‰ç§æ˜ç¡®çš„è®¤è¯çŠ¶æ€
2. **è°ƒè¯•å‹å¥½**ï¼šconsole.log æ˜¾ç¤ºå½“å‰çŠ¶æ€
3. **å¯æ‰©å±•æ€§**ï¼šæ–°çš„è®¤è¯çŠ¶æ€å¯ä»¥è½»æ¾æ·»åŠ 

è¿™ä¸ªæ”¹è¿›ç¡®ä¿äº† Favorites é¡µé¢åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½èƒ½æä¾›å‡†ç¡®ã€æœ‰ç”¨çš„ç”¨æˆ·ä½“éªŒã€‚