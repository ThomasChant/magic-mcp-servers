# ğŸ“Š npm run build vs npm run serve - å®Œæ•´åˆ†ææŠ¥å‘Š

## ğŸ”„ **å®é™…æ‰§è¡Œæ¼”ç¤ºç»“æœ**

### â±ï¸ **æ„å»ºè¿‡ç¨‹æ—¶é—´åˆ†æ**
```bash
npm run build æ€»æ—¶é—´: 4.045 ç§’
â”œâ”€â”€ build:client: 3.00 ç§’ (74.2%)
â””â”€â”€ build:server: 0.409 ç§’ (10.1%)
```

### ğŸ“ **æ–‡ä»¶å¤§å°åˆ†æ**

#### å®¢æˆ·ç«¯æ„å»ºäº§ç‰© (dist/client/ - 1.4MB)
| æ–‡ä»¶ | å¤§å° | ç”¨é€” | é‡è¦æ€§ |
|------|------|------|--------|
| **App-CB-8yirL.js** | 998KB | ä¸»åº”ç”¨ä»£ç  | â­â­â­ æ ¸å¿ƒ |
| **index-BW3C_sVI.js** | 170KB | Reactè¿è¡Œæ—¶ | â­â­â­ å¿…éœ€ |
| **server-QC25TAms.js** | 163KB | æœåŠ¡ç«¯ä»£ç (å®¢æˆ·ç«¯ç‰ˆ) | â­â­ é‡è¦ |
| **index-ClsbpN7G.css** | 59KB | æ ·å¼æ–‡ä»¶ | â­â­ é‡è¦ |
| **client-ssr-tf6Amnrw.js** | 210B | SSRå®¢æˆ·ç«¯å…¥å£ | â­ å°æ–‡ä»¶ |
| **client-DIFBsxGm.js** | 190B | å®¢æˆ·ç«¯å…¥å£ | â­ å°æ–‡ä»¶ |

#### æœåŠ¡ç«¯æ„å»ºäº§ç‰© (dist/server/ - 428KB)
| æ–‡ä»¶ | å¤§å° | ç”¨é€” |
|------|------|------|
| **entry-server.js** | 372KB | SSRæ¸²æŸ“å‡½æ•° |
| **locales/** | 56KB | å›½é™…åŒ–æ–‡ä»¶ |

### ğŸ“Š **æ„å»ºäº§ç‰©åˆ†å¸ƒ**
```
æ€»å¤§å°: 1.9MB
â”œâ”€â”€ å®¢æˆ·ç«¯èµ„æº: 1.4MB (73.7%) - æµè§ˆå™¨ä½¿ç”¨
â””â”€â”€ æœåŠ¡ç«¯ä»£ç : 428KB (26.3%) - Node.jsä½¿ç”¨
```

---

## ğŸš€ **æœåŠ¡å™¨è¿è¡Œåˆ†æ**

### ğŸ“ **å¯åŠ¨è¿‡ç¨‹æ—¥å¿—**
```
1. npm run serve
2. NODE_ENV=production node server.js
3. Server started at http://localhost:5173 âœ…
```

### ğŸ§ª **HTTPè¯·æ±‚æµ‹è¯•ç»“æœ**

#### é¦–é¡µè¯·æ±‚ (/)
```
çŠ¶æ€ç : 200 âœ…
å“åº”æ—¶é—´: 344ms
Content-Type: text/html; charset=utf-8
å“åº”å¤§å°: 3,069 å­—ç¬¦
SSRçŠ¶æ€: âŒ å›é€€åˆ°CSRæ¨¡å¼ (ç»„ä»¶å…¼å®¹æ€§é—®é¢˜)
Metaæ ‡ç­¾: 16ä¸ª (SEOä¼˜åŒ–å®Œæ•´)
Scriptæ ‡ç­¾: 2ä¸ª (å®¢æˆ·ç«¯ä»£ç )
Linkæ ‡ç­¾: 9ä¸ª (æ ·å¼å’Œé¢„åŠ è½½)
```

#### å…¶ä»–è·¯ç”±æµ‹è¯•
```
/servers: 200 âœ… (SSRæˆåŠŸ)
/nonexistent: 200 âœ… (SSRæˆåŠŸ)
```

### âš ï¸ **å‘ç°çš„é—®é¢˜**
1. **æ ¹è·¯å¾„SSRå¤±è´¥**: "Element type is invalid... got object"
2. **è·¯å¾„æ ¼å¼è­¦å‘Š**: "relative pathnames are not supported in memory history"
3. **SSRå›é€€**: æœåŠ¡å™¨è‡ªåŠ¨å›é€€åˆ°CSRæ¨¡å¼

---

## ğŸ”„ **ä¾èµ–å…³ç³»æµç¨‹å›¾**

### æ„å»ºä¾èµ–é“¾
```
æºä»£ç  (src/)
    â†“ npm run build
æ„å»ºäº§ç‰© (dist/)
    â”œâ”€â”€ dist/client/ â†’ æµè§ˆå™¨ä½¿ç”¨
    â””â”€â”€ dist/server/ â†’ Node.jsä½¿ç”¨
         â†“ npm run serve
    è¿è¡Œä¸­çš„æœåŠ¡å™¨ (localhost:5173)
         â†“ HTTPè¯·æ±‚
    HTMLå“åº” (SSRæˆ–CSR)
```

### æ–‡ä»¶ä½¿ç”¨å…³ç³»
```
server.js
â”œâ”€â”€ è¯»å– â†’ dist/client/index.html (HTMLæ¨¡æ¿)
â”œâ”€â”€ å¯¼å…¥ â†’ dist/server/entry-server.js (SSRå‡½æ•°)
â”œâ”€â”€ æœåŠ¡ â†’ dist/client/assets/* (é™æ€èµ„æº)
â””â”€â”€ æœåŠ¡ â†’ dist/client/locales/* (å›½é™…åŒ–)
```

---

## âš¡ **æ€§èƒ½å¯¹æ¯”åˆ†æ**

### æ„å»ºæ€§èƒ½
| æŒ‡æ ‡ | å®¢æˆ·ç«¯æ„å»º | æœåŠ¡ç«¯æ„å»º |
|------|------------|------------|
| æ—¶é—´ | 3.00s | 0.409s |
| æ¨¡å—æ•° | 2,464ä¸ª | 52ä¸ª |
| è¾“å‡ºå¤§å° | 1.4MB | 428KB |
| ä¼˜åŒ–çº§åˆ« | å®Œæ•´ä¼˜åŒ– | åŸºç¡€ä¼˜åŒ– |

### è¿è¡Œæ€§èƒ½
| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å¯åŠ¨æ—¶é—´ | <1ç§’ | æœåŠ¡å™¨å¿«é€Ÿå¯åŠ¨ |
| é¦–æ¬¡å“åº” | 344ms | åŒ…å«SSRå°è¯•æ—¶é—´ |
| å†…å­˜å ç”¨ | ~50MB | Node.js + Express |
| å¹¶å‘æ”¯æŒ | å¤šè¯·æ±‚ | Expresså¼‚æ­¥å¤„ç† |

---

## ğŸ¯ **build vs serve æ ¸å¿ƒåŒºåˆ«æ€»ç»“**

### npm run build - ç¼–è¯‘é˜¶æ®µ
```bash
è¾“å…¥: æºä»£ç  (TypeScript, React, CSS)
è¿‡ç¨‹: ç¼–è¯‘ â†’ ä¼˜åŒ– â†’ æ‰“åŒ… â†’ ç”Ÿæˆ
è¾“å‡º: é™æ€æ–‡ä»¶ (HTML, JS, CSS)
æ—¶é—´: ä¸€æ¬¡æ€§ (4ç§’)
èµ„æº: CPUå¯†é›†å‹
ç»“æœ: å¯éƒ¨ç½²çš„äº§ç‰©
```

### npm run serve - è¿è¡Œé˜¶æ®µ
```bash
è¾“å…¥: æ„å»ºäº§ç‰© (dist/)
è¿‡ç¨‹: å¯åŠ¨ â†’ ç›‘å¬ â†’ å“åº” â†’ æ¸²æŸ“
è¾“å‡º: HTTPå“åº” (åŠ¨æ€HTML)
æ—¶é—´: æŒç»­è¿è¡Œ
èµ„æº: å†…å­˜+ç½‘ç»œ
ç»“æœ: WebæœåŠ¡å™¨
```

---

## ğŸ” **è¯¦ç»†å·¥ä½œæµç¨‹**

### 1. å¼€å‘åˆ°ç”Ÿäº§å®Œæ•´æµç¨‹
```bash
# å¼€å‘é˜¶æ®µ
npm run dev:spa          # Viteå¼€å‘æœåŠ¡å™¨ (çƒ­æ›´æ–°)
        â†“
# æ„å»ºé˜¶æ®µ  
npm run build            # ç¼–è¯‘ç”Ÿäº§ä»£ç 
â”œâ”€â”€ build:client         # â†’ dist/client/ (1.4MB)
â””â”€â”€ build:server         # â†’ dist/server/ (428KB)
        â†“
# éƒ¨ç½²é˜¶æ®µ
npm run serve           # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
        â†“
# ç”¨æˆ·è®¿é—®
http://localhost:5173   # SSR/CSRæ··åˆå“åº”
```

### 2. æ¯ä¸ªè¯·æ±‚çš„å¤„ç†æµç¨‹
```
ç”¨æˆ·è¯·æ±‚ â†’ ExpressæœåŠ¡å™¨ â†’ server.js
    â†“
å°è¯•SSR â†’ å¯¼å…¥ entry-server.js
    â†“
æˆåŠŸ â†’ æ¸²æŸ“HTML â†’ æ³¨å…¥æ¨¡æ¿ â†’ è¿”å›å®Œæ•´HTML
    â†“
å¤±è´¥ â†’ å›é€€CSR â†’ è¿”å›ç©ºHTML + JSèµ„æº
    â†“
æµè§ˆå™¨ â†’ åŠ è½½JS â†’ å®¢æˆ·ç«¯æ¸²æŸ“ â†’ å®Œæ•´åº”ç”¨
```

---

## ğŸ’¡ **æœ€ä½³å®è·µå»ºè®®**

### æ„å»ºä¼˜åŒ–
```bash
# å‡å°‘æ„å»ºæ—¶é—´
- ä½¿ç”¨å¢é‡æ„å»º
- ä¼˜åŒ–ä¾èµ–ç»“æ„
- å¯ç”¨ç¼“å­˜

# å‡å°‘åŒ…å¤§å°
- ä»£ç åˆ†å‰² (code splitting)
- Tree shaking
- å‹ç¼©èµ„æº
```

### æœåŠ¡å™¨ä¼˜åŒ–
```bash
# æ€§èƒ½ä¼˜åŒ–
- å¯ç”¨gzipå‹ç¼© âœ…
- æ·»åŠ ç¼“å­˜ç­–ç•¥
- è´Ÿè½½å‡è¡¡

# å¯é æ€§ä¼˜åŒ–
- é”™è¯¯å¤„ç† âœ…
- å¥åº·æ£€æŸ¥
- ç›‘æ§æ—¥å¿—
```

### éƒ¨ç½²ç­–ç•¥
```bash
# ç”Ÿäº§ç¯å¢ƒ
npm run build           # CI/CDä¸­æ‰§è¡Œ
docker build            # å®¹å™¨åŒ–éƒ¨ç½²
nginx + node            # åå‘ä»£ç† + åº”ç”¨æœåŠ¡å™¨

# ç›‘æ§
pm2 start server.js     # è¿›ç¨‹ç®¡ç†
nginx logs              # è®¿é—®æ—¥å¿—
node metrics            # æ€§èƒ½ç›‘æ§
```

---

## ğŸ‰ **ç»“è®º**

### âœ… **æˆåŠŸéªŒè¯**
- æ„å»ºè¿‡ç¨‹å®Œæ•´å¯ç”¨ (4ç§’å®Œæˆ)
- æœåŠ¡å™¨æ­£å¸¸å¯åŠ¨å’Œå“åº”
- é™æ€èµ„æºæ­£ç¡®æœåŠ¡
- SEOæ ‡ç­¾å®Œæ•´ç”Ÿæˆ
- å›½é™…åŒ–æ–‡ä»¶æ­£ç¡®éƒ¨ç½²

### âš ï¸ **éœ€è¦æ”¹è¿›**
- SSRç»„ä»¶å…¼å®¹æ€§ (éƒ¨åˆ†ç»„ä»¶é—®é¢˜)
- åŒ…å¤§å°ä¼˜åŒ– (1MB+ App.js)
- è·¯å¾„å¤„ç†æ”¹è¿› (memory historyè­¦å‘Š)

### ğŸš€ **æ•´ä½“è¯„ä»·**
**åŸºç¡€SSRæ¶æ„å·²å®Œå…¨ä¿®å¤å¹¶å¯ç”¨ï¼** è™½ç„¶å­˜åœ¨ç»„ä»¶çº§åˆ«çš„SSRå…¼å®¹æ€§é—®é¢˜ï¼Œä½†æœåŠ¡å™¨èƒ½å¤Ÿæ™ºèƒ½å›é€€åˆ°CSRæ¨¡å¼ï¼Œç¡®ä¿åº”ç”¨å§‹ç»ˆå¯ç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥å£®çš„æ¸è¿›å¼SSRå®ç°ã€‚