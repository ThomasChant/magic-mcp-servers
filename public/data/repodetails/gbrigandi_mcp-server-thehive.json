{
  "mcp_name": "gbrigandi/mcp-server-thehive",
  "mcp_description": "ü¶Ä üè† üö® üçé ü™ü üêß - A Rust-based MCP server to integrate TheHive, facilitating collaborative security incident response and case management via AI.",
  "mcp_id": "gbrigandi_mcp-server-thehive",
  "fetch_timestamp": "2025-06-23T03:42:47.025444Z",
  "github_url": "https://github.com/gbrigandi/mcp-server-thehive",
  "repository": {
    "name": "mcp-server-thehive",
    "full_name": "gbrigandi/mcp-server-thehive",
    "description": "MCP Server for TheHive",
    "html_url": "https://github.com/gbrigandi/mcp-server-thehive",
    "created_at": "2025-05-27T01:30:57Z",
    "updated_at": "2025-06-10T16:03:58Z",
    "pushed_at": "2025-05-27T01:41:45Z",
    "size": 29,
    "stargazers_count": 3,
    "watchers_count": 3,
    "forks_count": 1,
    "open_issues_count": 0,
    "language": "Rust",
    "license": "MIT License",
    "topics": [],
    "default_branch": "main",
    "owner": {
      "login": "gbrigandi",
      "type": "User",
      "avatar_url": "https://avatars.githubusercontent.com/u/671490?v=4",
      "html_url": "https://github.com/gbrigandi"
    },
    "has_issues": true,
    "has_projects": true,
    "has_downloads": true,
    "has_wiki": true,
    "has_pages": false,
    "archived": false,
    "disabled": false,
    "visibility": "public",
    "network_count": 1,
    "subscribers_count": 0,
    "languages": {
      "Rust": 93299,
      "Dockerfile": 1109
    },
    "language_percentages": {
      "Rust": 98.83,
      "Dockerfile": 1.17
    },
    "pull_requests_count": 0,
    "contributors_count": 1,
    "latest_release": {
      "tag_name": "v0.1.0",
      "name": "Release v0.1.0",
      "published_at": "2025-05-27T01:41:53Z",
      "body": "",
      "prerelease": false,
      "draft": false
    },
    "tags": [
      {
        "name": "v0.1.0",
        "commit_sha": "323d2a1529a4b996e40626f3de998ea8197385bb"
      }
    ],
    "latest_version": "v0.1.0"
  },
  "readme": "# MCP Server for TheHive\n\nAn MCP (Model Context Protocol) server that provides AI models and automation tools with access to TheHive incident response platform.\n\n## Overview\n\nThis server acts as a bridge between MCP clients (like AI assistants) and TheHive, allowing them to:\n\n- Retrieve and analyze security alerts\n- Access case information\n- Promote alerts to cases\n- Perform incident response operations\n\n## Features\n\n### Available Tools\n\n1. **get_thehive_alerts** - Retrieve a list of alerts from TheHive\n   - Optional `limit` parameter (default: 100)\n   - Returns formatted alert information including ID, title, severity, and status\n\n2. **get_thehive_alert_by_id** - Get detailed information about a specific alert\n   - Required `alert_id` parameter\n   - Returns comprehensive alert details\n\n3. **get_thehive_cases** - Retrieve a list of cases from TheHive\n   - Optional `limit` parameter (default: 100)\n   - Returns formatted case information\n\n4. **get_thehive_case_by_id** - Get detailed information about a specific case\n   - Required `case_id` parameter\n   - Returns comprehensive case details\n\n5. **promote_alert_to_case** - Promote an alert to a case\n   - Required `alert_id` parameter\n   - Returns information about the newly created case\n\n6. **create_thehive_case** - Create a new case in TheHive\n   - Required `title` and `description` parameters\n   - Optional parameters: `severity`, `tags`, `tlp`, `pap`, `status`, `assignee`, `case_template`, `start_date`\n   - Returns information about the newly created case\n\n## Installation\n\n### Prerequisites\n\n- Access to a TheHive 5 instance\n- Valid TheHive API token\n\n### Downloading Pre-compiled Binaries\n\nYou can download pre-compiled binaries for various operating systems from the [GitHub Releases page](https://github.com/gbrigandi/mcp-server-thehive/releases). Download the appropriate binary for your system, make it executable, and place it in your desired location.\n\n### Building from Source\n\n```bash\ngit clone <repository-url>\ncd mcp-server-thehive\ncargo build --release\n```\n\n## Configuration\n\nThe server requires the following environment variables:\n\n- `THEHIVE_URL` - TheHive API base URL (default: `http://localhost:9000/api`)\n- `THEHIVE_API_TOKEN` - TheHive API token (required)\n- `VERIFY_SSL` - Whether to verify SSL certificates (default: `false`)\n- `RUST_LOG` - Logging level (optional, e.g., `debug`, `info`)\n\n### Environment File\n\nCreate a `.env` file in the project root:\n\n```env\nTHEHIVE_URL=https://your-thehive-instance.com/api\nTHEHIVE_API_TOKEN=your-api-token-here\nVERIFY_SSL=true\nRUST_LOG=info\n```\n\n### Getting a TheHive API Token\n\n1. Log into your TheHive instance\n2. Go to **User Settings** ‚Üí **API Keys**\n3. Click **Create API Key**\n4. Copy the generated token and use it as `THEHIVE_API_TOKEN`\n\n## Usage\n\n### Running the Server\n\n```bash\n# Using cargo\ncargo run\n\n# Using the built binary\n./target/release/mcp-server-thehive\n```\n\n### Integration with MCP Clients\n\nThe server communicates over stdio using the MCP protocol. Configure your MCP client to use this server:\n\n```json\n{\n  \"mcpServers\": {\n    \"thehive\": {\n      \"command\": \"/path/to/mcp-server-thehive\",\n      \"env\": {\n        \"THEHIVE_URL\": \"https://your-thehive-instance.com:9000/api\",\n        \"THEHIVE_API_TOKEN\": \"your-api-token-here\"\n      }\n    }\n  }\n}\n```\n\n## Examples\n\n### Retrieving Recent Alerts\n\n```json\n{\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"get_thehive_alerts\",\n    \"arguments\": {\n      \"limit\": 10\n    }\n  }\n}\n```\n\n### Getting Alert Details\n\n```json\n{\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"get_thehive_alert_by_id\",\n    \"arguments\": {\n      \"alert_id\": \"~123456\"\n    }\n  }\n}\n```\n\n### Promoting an Alert to Case\n\n```json\n{\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"promote_alert_to_case\",\n    \"arguments\": {\n      \"alert_id\": \"~123456\"\n    }\n  }\n}\n```\n\n### Creating a New Case\n\n```json\n{\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"create_thehive_case\",\n    \"arguments\": {\n      \"title\": \"Potential Malware Outbreak\",\n      \"description\": \"Multiple endpoints reporting suspicious process activity.\",\n      \"severity\": 3,\n      \"tags\": [\"malware\", \"endpoint\", \"epp\"],\n      \"tlp\": 2,\n      \"assignee\": \"soc_level2\"\n    }\n  }\n}\n```\n\n## Development\n\n### Project Structure\n\n```\nmcp-server-thehive/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ main.rs              # Main server implementation\n‚îÇ   ‚îú‚îÄ‚îÄ lib.rs               # Library exports\n‚îÇ   ‚îî‚îÄ‚îÄ thehive/\n‚îÇ       ‚îú‚îÄ‚îÄ mod.rs           # Module declarations\n‚îÇ       ‚îú‚îÄ‚îÄ client.rs        # TheHive API client\n‚îÇ       ‚îî‚îÄ‚îÄ error.rs         # Error types\n‚îú‚îÄ‚îÄ tests/\n‚îÇ   ‚îú‚îÄ‚îÄ bin/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mock_thehive_server.rs # Mock TheHive API server for testing\n‚îÇ   ‚îú‚îÄ‚îÄ integration_test.rs    # Integration tests\n‚îÇ   ‚îî‚îÄ‚îÄ mcp_stdio_test.rs      # Stdio interface tests\n‚îú‚îÄ‚îÄ Cargo.toml               # Dependencies and metadata\n‚îî‚îÄ‚îÄ README.md                # This file\n```\n\n### Dependencies\n\n- **rmcp** - MCP protocol implementation\n- **thehive-client** - TheHive API client library\n- **tokio** - Async runtime\n- **reqwest** - HTTP client\n- **serde** - Serialization framework\n- **tracing** - Logging and instrumentation\n\n### Testing\n\nThe project includes a comprehensive suite of integration tests that leverage a mock TheHive server. This mock server simulates the TheHive API, allowing for isolated and repeatable testing of the MCP server's functionality without requiring a live TheHive instance.\n\n**Running Tests:**\n\n```bash\n# Run all tests (including integration tests that use the mock server)\ncargo test\n\n# Run tests with verbose logging (includes MCP server and mock server logs)\nRUST_LOG=debug MCP_SERVER_THEHIVE_VERBOSE_TEST_LOGS=true cargo test\n```\n\n## Security Considerations\n\n- Store API tokens securely (use environment variables or secure credential stores)\n- Never commit API tokens to version control\n- Enable SSL verification in production environments\n- Limit network access to TheHive instance\n- Use least-privilege API tokens for TheHive access\n- Monitor and log all API interactions\n- Rotate API tokens regularly\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Connection Refused**\n   - Verify `THEHIVE_URL` is correct\n   - Check network connectivity to TheHive instance\n   - Ensure TheHive is running and accessible\n\n2. **Authentication Failed**\n   - Verify `THEHIVE_API_TOKEN` is correct and not expired\n   - Check if the API token has necessary permissions\n   - Ensure the token is properly formatted\n\n3. **SSL Certificate Errors**\n   - Set `VERIFY_SSL=false` for testing (not recommended for production)\n   - Install proper SSL certificates\n   - Use valid certificate authority\n\n### Logging\n\nEnable debug logging for troubleshooting:\n\n```bash\nRUST_LOG=debug cargo run\n```\n\n## Contributing\n\n1. Fork the repository\n2. Create a feature branch\n3. Make your changes\n4. Add tests if applicable\n5. Submit a pull request\n\n## License\n \nThis project is licensed under the MIT License - see the LICENSE file for details.\n\n## Related Projects\n\n- [thehive-client-rs](https://github.com/gbrigandi/thehive-client-rs) - Rust client library for TheHive API\n- [mcp-server-cortex](https://github.com/gbrigandi/mcp-server-cortex) - MCP server for Cortex\n- [mcp-server-wazuh](https://github.com/gbrigandi/mcp-server-wazuh) - MCP server for Wazuh SIEM\n"
}