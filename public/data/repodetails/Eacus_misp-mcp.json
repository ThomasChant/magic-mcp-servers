{
  "mcp_name": "Eacus/misp-mcp",
  "mcp_description": "Facilitates interaction with MISP through a Model Context Protocol server, enabling seamless integration with AI models for enhanced data management and analysis.",
  "mcp_id": "Eacus_misp-mcp",
  "fetch_timestamp": "2025-06-23T02:45:43.161753Z",
  "github_url": "https://github.com/Eacus/misp-mcp",
  "repository": {
    "name": "misp-mcp",
    "full_name": "Eacus/misp-mcp",
    "description": "A Model Context Protocol server allows to interact with MISP",
    "html_url": "https://github.com/Eacus/misp-mcp",
    "created_at": "2025-04-07T08:18:07Z",
    "updated_at": "2025-06-19T18:08:05Z",
    "pushed_at": "2025-04-09T16:03:24Z",
    "size": 2734,
    "stargazers_count": 7,
    "watchers_count": 7,
    "forks_count": 0,
    "open_issues_count": 0,
    "language": "Python",
    "license": null,
    "topics": [],
    "default_branch": "main",
    "owner": {
      "login": "Eacus",
      "type": "User",
      "avatar_url": "https://avatars.githubusercontent.com/u/11554148?v=4",
      "html_url": "https://github.com/Eacus"
    },
    "has_issues": true,
    "has_projects": true,
    "has_downloads": true,
    "has_wiki": true,
    "has_pages": false,
    "archived": false,
    "disabled": false,
    "visibility": "public",
    "network_count": 0,
    "subscribers_count": 1,
    "languages": {
      "Python": 16858
    },
    "language_percentages": {
      "Python": 100
    },
    "pull_requests_count": 0,
    "contributors_count": 2
  },
  "readme": "# MISP-mcp\n\n\n## What is MCP?\n\n The **Model Context Protocol (MCP)** is an open protocol designed to standardize how applications provide contextual information to large language models (LLMs). Much like how **USB-C** serves as a universal interface for connecting hardware devices, **MCP acts as a universal connector** between AI models and various data sources or tools. This standardization simplifies integration and enhances the adaptability and functionality of AI-powered applications.\n\n###  Why MCP?\n\nMCP helps you build agents and complex workflows on top of LLMs. LLMs frequently need to integrate with data and tools, and MCP provides:\n\n- A growing list of pre-built integrations that your LLM can directly plug into\n- The flexibility to switch between LLM providers and vendors\n- Best practices for securing your data within your infrastructure\n\n### General architecture\n\nAt its core, MCP follows a client-server architecture where a host application can connect to multiple servers:\n\n![image-20250409162936741](./imagemd/image-20250409162936741.png)\n\n- **MCP Hosts**: Programs like Claude Desktop, IDEs, or AI tools that want to access data through MCP\n- **MCP Clients**: Protocol clients that maintain 1:1 connections with servers\n- **MCP Servers**: Lightweight programs that each expose specific capabilities through the standardized Model Context Protocol\n- **Local Data Sources**: Your computerâ€™s files, databases, and services that MCP servers can securely access\n- **Remote Services**: External systems available over the internet (e.g., through APIs) that MCP servers can connect to\n\n## Get started \n\n1. Clone the repository \n\n```bash\ngit clone https://github.com/Eacus/misp-mcp.git\n```\n\n2. Install [Claude Desktop](https://claude.ai/download) \n\n   1. Follow the guide https://modelcontextprotocol.io/quickstart/user\n   2. Add the following MCP configuration \n\n   ```json\n   {\n       \"mcpServers\": {\n           \"MISP-mcp\":{\n                       \"command\": \"uv\",\n               \"args\": [\n                   \"--directory\",\n                   \"<path_to_repo>/server/\",\n                   \"run\",\n                   \"server.py\"\n               ]\n           }\n       }\n   }\n   ```\n\n3. Restart Claude desktop\n\n## Basic Usage\n\n### Search Event by ID\n\n#### Prompting with `misp-mcp`\n\n> Can you give to me  the MISP event with id 119?\n\n![image-20250409160824466](./imagemd/image-20250409160824466.png)\n\n#### GUI\n\n![image-20250409150858330](./imagemd/image-20250409150858330.png)\n\n#### PyMISP\n\n```python\n\nmisp_url = 'https://127.0.0.1:8443'\nmisp_key = '<misp_key>'\n# Should PyMISP verify the MISP certificate\nmisp_verifycert = False\nr = misp.search(eventid=[119], metadata=True, pythonify=True)\n```\n\n### Create an event\n\n#### Prompting with `misp-mcp`\n\n> Create a new MISP event with the following parameters:\n>\n> - Info: `This is my new MISP event`\n> - Distribution: `0` (Your organization only)\n> - Threat Level ID: `2` (Medium)\n> - Analysis Level: `1` (Ongoing)\n\n![image-20250409163209884](./imagemd/image-20250409163209884.png)\n\n#### GUI\n\n![image-20250409150904842](./imagemd/image-20250409150904842.png)\n\n#### PyMISP\n\n```python\nfrom pymisp import MISPEvent\n\nevent = MISPEvent()\n\nevent.info = 'This is my new MISP event'  # Required\nevent.distribution = 0  # Optional, defaults to MISP.default_event_distribution in MISP config\nevent.threat_level_id = 2  # Optional, defaults to MISP.default_event_threat_level in MISP config\nevent.analysis = 1  # Optional, defaults to 0 (initial analysis)\n\nprint(event.to_json())\n```\n\n## Administrative task\n\n### Create an user\n\n![image-20250409170428039](./imagemd/image-20250409170428039.png)\n\n![image-20250409170506173](./imagemd/image-20250409170506173.png)\n\n#### Prompting with `misp-mcp`\n\n> Add a new user to the MISP instance using the following required fields:\n>\n> - `email@email.com`: the email address associated with the account\n> - `test_id`: the ID of the organization the user belongs to\n> - `role_id`: the ID of the role assigned to the user\n\n#### GUI\n\n![image-20250409150913949](./imagemd/image-20250409150913949.png)\n\n#### PyMisp\n\n```python\nfrom pymisp import ExpandedPyMISP, MISPUser\nfrom keys import misp_url, misp_key, misp_verifycert\nimport argparse\n\n\n    misp = ExpandedPyMISP(misp_url, misp_key, misp_verifycert, 'json')\n\n    user = MISPUser()\n    user.email = <email>\n    user.org_id = <org_id>\n    user.role_id = <role_id>\n\n    misp.add_user(user, pythonify=True)\n```\n\n## Add AI Capabilities!\n\n> Summarise  all information about the MISP events that happened yesterday?\n\n![image-20250409174116947](./imagemd/image-20250409174116947.png)\n\n![image-20250409174135317](./imagemd/image-20250409174135317.png)\n\n![image-20250409174212905](./imagemd/image-20250409174212905.png)\n\n![image-20250409174228425](./imagemd/image-20250409174228425.png)\n\n> Generate a report written in Markdown based on the MISP event with id 114 \n\n![image-20250409172033250](./imagemd/image-20250409172033250.png)\n\n```\n# MISP Event Report: Configuration and Security Posture Issues\n\n## Event Details\n\n- **Event ID:** 114\n- **UUID:** 9d8c6821-0db5-4745-bb58-aac4f04eab78\n- **Date:** 2025-03-25\n- **Status:** Not Published\n- **Threat Level:** 4\n- **Distribution:** 1 (Organization)\n- **Analysis Status:** 0 (Initial)\n\n## Organization Information\n\n- **Organization:** ORG_Main\n- **Organization UUID:** 3094f85b-a22f-475b-a68f-ae77c233bb72\n- **Event Creator:** user88@org-admin.main.test\n\n## Description\n\nThis event focuses on \"Configuration and Security Posture Issues.\" It appears to be in an initial stage of analysis and has not yet been published within the MISP instance.\n\n## Attributes\n\nNo attributes have been added to this event yet.\n\n## Objects\n\nNo objects have been associated with this event.\n\n## Related Events\n\nNo related events have been linked to this event.\n\n## Galaxies\n\nNo galaxies have been associated with this event.\n\n## Summary\n\nThis MISP event (ID: 114) is currently in development and focuses on configuration and security posture issues. The event has been created but does not yet contain any attributes, objects, or relationships with other events. The event is set to be shared only within the organization (ORG_Main).\n\n## Recommendations\n\n1. Add relevant attributes to provide context about the specific configuration and security posture issues being addressed\n2. Consider adding objects to structure the information more effectively\n3. Link to related events if applicable\n4. Determine appropriate galaxies to categorize the threat information\n5. Review the threat level assignment to ensure it accurately reflects the severity\n6. Consider publishing the event when it contains sufficient information\n\n------\n\n*Report generated on April 9, 2025*\n```\n\n"
}